
<script type="text/javascript" src="/public/touchscreentoolkit/lib/javascripts/touchScreenToolkit.js" defer="true"></script>
<!-- <script type="text/javascript" src="/public/touchscreentoolkit/lib/javascripts/standard.js" defer="true"></script> -->
<script type="text/javascript" src="/assets/js/jquery.min.js"></script>


<script type="text/javascript" src="/assets/js/post_parameters.js"></script>
<script type="text/javascript" src="/assets/js/client-scan-barcode.js"></script>
<script>

function addBarcode() {
  var iFrame = document.getElementById("inputFrame0");
  var barcodeDiv = document.createElement("div");
  barcodeDiv.setAttribute("class","barcode");
  barcodeDiv.setAttribute("functionName","scannedBarcode");
  iFrame.appendChild(barcodeDiv);

  iFrame.style = "width: 96%;";
  inserBarcodeScan();
}

  function scannedBarcode(barcode) {
    barcode = barcode.slice(0, barcode.length);
    
    var url = 'http://' + apiURL + ':' + apiPort + '/api/v1/locations/' + barcode;
    var req = new XMLHttpRequest();
    req.onreadystatechange = function () {

      if (this.readyState == 4) {
        if (this.status == 200) {
          var results = JSON.parse(this.responseText);
          sessionStorage.setItem("userLocation", barcode);
          document.location = "/";
        } else if (this.status == 404) {
          showMessage("invalid location");
        } else if (this.status == 401) {
          showMessage("authentication has expired, logging out");
          document.location = "login.html";
        }

      }
    };
    try {
      req.open('GET', url, true);
      req.setRequestHeader('Authorization', sessionStorage.getItem('authorization'));
      req.send(null);
    } catch (e) {
    }
  }


</script>

<body id="mateme">
  <div id="container">
    <div id="content">


      <form onsubmit="submitEncounter();">

        <input type="text" name="location" tt_onLoad="__$('keyboard').style.display = 'none';addBarcode();" 
          tt_pageStyleClass= "NoControls" helpText="Work-station location" optional = "true"/>


      </form>

   </div>
 </div>
</body>

